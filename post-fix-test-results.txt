
=== Running Tests ===
[95mPester v5.7.1[0m
[95m
[95mStarting discovery in 9 files.[0m
[95mDiscovery found 239 tests in 1.33s.[0m
[95mRunning tests.[0m
[95m
[95mRunning tests from 'C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1'[0m
[33;1mWARNING: The names of some imported commands from the module 'GitHubApiClient' include unapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the Import-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.[0m
[92mDescribing Update Orchestrator Integration Tests[0m
[96m Context Scenario 1: Standard Update (No Conflicts)[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should complete update successfully[0m[90m 785ms (760ms|25ms)[0m
[91m    Expected 0, but got 1.
[91m    at $LASTEXITCODE | Should -Be 0, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:213
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:213[0m
[91m   [-] Should update manifest version[0m[90m 48ms (47ms|1ms)[0m
[91m    Expected strings to be the same, but they were different.
[91m    String lengths are both 7.
[91m    Strings differ at index 5.
[91m    Expected: 'v0.0.72'
[91m    But was:  'v0.0.45'
[91m               -----^
[91m    at $manifest.speckit_version | Should -Be "v0.0.72", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:225
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:225[0m
[91m   [-] Should create backup[0m[90m 16ms (15ms|1ms)[0m
[91m    Expected $true, but got $false.
[91m    at Test-Path $backupsDir | Should -BeTrue, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:234
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:234[0m
[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:244[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 244 | [0m             $content = [36;1mGet-Content $specifyFile -Raw[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\test-project-254289132\.claude\commands\speckit.specify.md'[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mbecause it does not exist.[0m
[91m   [-] Should update files with new content[0m[90m 61ms (61ms|1ms)[0m
[91m    Expected like wildcard '*Updated Specify Command*' to match $null, but it did not match.
[91m    at $content | Should -BeLike "*Updated Specify Command*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:247
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:247[0m
[96m Context Scenario 2: Update with Customizations[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Prerequisites not met:
  X Not a SpecKit project (.specify/ directory not found)


========================================
Update Failed
========================================

Error: Prerequisites validation failed. Please fix the issues above and try again.

No backup available for automatic rollback

[32m   [+] Should preserve customized files[0m[90m 180ms (177ms|3ms)[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Prerequisites not met:
  X Not a SpecKit project (.specify/ directory not found)


========================================
Update Failed
========================================

Error: Prerequisites validation failed. Please fix the issues above and try again.

No backup available for automatic rollback

[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:297[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 297 | [0m             $content = [36;1mGet-Content $planFile -Raw[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m                        ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\test-project-632935010\.claude\commands\speckit.plan.md'[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mbecause it does not exist.[0m
[91m   [-] Should update non-customized files[0m[90m 168ms (167ms|1ms)[0m
[91m    Expected like wildcard '*Updated Plan Command*' to match $null, but it did not match.
[91m    at $content | Should -BeLike "*Updated Plan Command*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:298
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:298[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Prerequisites not met:
  X Not a SpecKit project (.specify/ directory not found)


========================================
Update Failed
========================================

Error: Prerequisites validation failed. Please fix the issues above and try again.

No backup available for automatic rollback

[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:308[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 308 | [0m             $manifest = [36;1mGet-Content $manifestPath -Raw[0m | ConvertFrom- .[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\test-project-632935010\.specify\manifest.json' because it[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mdoes not exist.[0m
[91m   [-] Should mark customizations in manifest[0m[90m 162ms (161ms|1ms)[0m
[91m    Expected $true, but got $null.
[91m    at $customizedFile.customized | Should -BeTrue, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:312
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:312[0m
[96m Context Scenario 3: Update with Conflicts[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.71

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should detect conflicts[0m[90m 234ms (232ms|1ms)[0m
[91m    Expected like wildcard '*conflict*' to match <empty>, but it did not match.
[91m    at $output | Should -BeLike "*conflict*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:361
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:361[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.71

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should invoke conflict resolution workflow[0m[90m 249ms (248ms|1ms)[0m
[91m    RuntimeException: Should -Invoke: Could not find Mock for command Open-MergeEditor in module VSCodeIntegration. Was the mock defined? Did you use the same -ModuleName as on the Mock? When using InModuleScope are InModuleScope, Mock and Should -Invoke using the same -ModuleName?[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.71

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should resolve conflict based on user choice[0m[90m 272ms (271ms|1ms)[0m
[91m    Expected like wildcard '*Upstream Updated Specify*' to match '# My Custom Specify
[91m    User modified content.
[91m    ', but it did not match.
[91m    at $content | Should -BeLike "*Upstream Updated Specify*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:385
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:385[0m
[96m Context Scenario 4: First-Time Manifest Generation[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
No manifest found. Creating new manifest...

This will scan your current .specify/ and .claude/ directories
and mark all files as customized (safe default).


========================================
Update Failed
========================================

Error: Cannot process command because of one or more missing mandatory parameters: SpecKitVersion.

No backup available for automatic rollback

[91m   [-] Should offer to create manifest[0m[90m 182ms (180ms|2ms)[0m
[91m    Expected like wildcard '*No manifest found*' to match <empty>, but it did not match.
[91m    at $output | Should -BeLike "*No manifest found*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:415
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:415[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
No manifest found. Creating new manifest...

This will scan your current .specify/ and .claude/ directories
and mark all files as customized (safe default).


========================================
Update Failed
========================================

Error: Cannot process command because of one or more missing mandatory parameters: SpecKitVersion.

No backup available for automatic rollback

[91m   [-] Should create manifest with current version[0m[90m 181ms (180ms|1ms)[0m
[91m    Expected $true, but got $false.
[91m    at Test-Path $manifestPath | Should -BeTrue, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:428
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:428[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
No manifest found. Creating new manifest...

This will scan your current .specify/ and .claude/ directories
and mark all files as customized (safe default).


========================================
Update Failed
========================================

Error: Cannot process command because of one or more missing mandatory parameters: SpecKitVersion.

No backup available for automatic rollback

[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:440[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 440 | [0m             $manifest = [36;1mGet-Content $manifestPath -Raw[0m | ConvertFrom- .[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\test-project-1524348381\.specify\manifest.json' because it[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mdoes not exist.[0m
[32m   [+] Should assume all files are customized[0m[90m 184ms (183ms|1ms)[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
No manifest found. Creating new manifest...

This will scan your current .specify/ and .claude/ directories
and mark all files as customized (safe default).


========================================
Update Failed
========================================

Error: Cannot process command because of one or more missing mandatory parameters: SpecKitVersion.

No backup available for automatic rollback

[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:459[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 459 | [0m             $manifest = [36;1mGet-Content $manifestPath -Raw[0m | ConvertFrom- .[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\test-project-1524348381\.specify\manifest.json' because it[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mdoes not exist.[0m
[91m   [-] Should track all existing files[0m[90m 201ms (201ms|1ms)[0m
[91m    Expected the actual value to be greater than 0, but got 0.
[91m    at $manifest.tracked_files.Count | Should -BeGreaterThan 0, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:462
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:462[0m
[96m Context Scenario 5: Custom Commands Preservation[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[32m   [+] Should preserve custom commands[0m[90m 240ms (239ms|1ms)[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:521[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 521 | [0m             $content = [36;1mGet-Content $officialCommand -Raw[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\test-project-170280411\.claude\commands\speckit.specify.md'[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mbecause it does not exist.[0m
[91m   [-] Should update official commands[0m[90m 237ms (236ms|1ms)[0m
[91m    Expected like wildcard '*Updated Specify*' to match $null, but it did not match.
[91m    at $content | Should -BeLike "*Updated Specify*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:522
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:522[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should list custom commands in summary[0m[90m 221ms (220ms|1ms)[0m
[91m    Expected like wildcard '*custom*' to match <empty>, but it did not match.
[91m    at $output | Should -BeLike "*custom*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:533
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:533[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should track custom commands in manifest[0m[90m 218ms (218ms|0ms)[0m
[91m    Expected 'custom.analyze-db.md' to be found in collection $null, but it was not found.
[91m    at $manifest.custom_files | Should -Contain "custom.analyze-db.md", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:546
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:546[0m
[96m Context Scenario 6: Rollback on Failure[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should trigger automatic rollback on failure[0m[90m 260ms (259ms|1ms)[0m
[91m    Expected like wildcard '*rollback*' to match <empty>, but it did not match.
[91m    at $output | Should -BeLike "*rollback*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:583
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:583[0m
[91m   [-] Should restore files to original state[0m[90m 17ms (16ms|0ms)[0m
[91m    ParameterBindingException: A parameter cannot be found that matches parameter name 'FromVersion'.
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:594[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[32m   [+] Should keep backup available for manual recovery[0m[90m 232ms (231ms|1ms)[0m
[96m Context Scenario 7: Backup Retention[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should prompt to cleanup old backups[0m[90m 226ms (225ms|1ms)[0m
[91m    Expected like wildcard '*old backup*' to match <empty>, but it did not match.
[91m    at $output | Should -BeLike "*old backup*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:669
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:669[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should keep only 5 most recent backups[0m[90m 224ms (223ms|0ms)[0m
[91m    Expected the actual value to be less than or equal to 6, but got 7.
[91m    at $backups.Count | Should -BeLessOrEqual 6  # 5 old + 1 new from this update, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:682
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:682[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should delete oldest backups first[0m[90m 253ms (245ms|8ms)[0m
[91m    Expected '20251013-135919' to not be found in collection @('20251013-135919', '20251014-135919', '20251015-135919', '20251016-135919', '20251017-135919', '20251018-135919', '20251019-135919'), but it was found.
[91m    at $backupsAfter.Name | Should -Not -Contain $oldestBefore.Name, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:698
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:698[0m
[96m Context Scenario 8: Command Lifecycle[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should add new official command[0m[90m 233ms (231ms|2ms)[0m
[91m    Expected $true, but got $false.
[91m    at Test-Path $newCommand | Should -BeTrue, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:744
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:744[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[32m   [+] Should remove obsolete official command[0m[90m 253ms (252ms|0ms)[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[32m   [+] Should NOT affect custom commands[0m[90m 231ms (230ms|0ms)[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should list new and removed commands in summary[0m[90m 246ms (245ms|0ms)[0m
[91m    Expected like wildcard '*added*' to match <empty>, but it did not match.
[91m    at $output | Should -BeLike "*new*" -Or ($output | Should -BeLike "*added*"), C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:787
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:787[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should update manifest with new command list[0m[90m 240ms (240ms|0ms)[0m
[91m    Expected 'speckit.analyze.md' to be found in collection @('speckit.constitution.md', 'speckit.specify.md', 'speckit.plan.md', 'speckit.tasks.md', 'speckit.implement.md'), but it was not found.
[91m    at $manifest.speckit_commands | Should -Contain "speckit.analyze.md", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:800
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:800[0m
[96m Context Additional Scenarios: Check-Only Mode[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should show update report without applying changes[0m[90m 234ms (233ms|1ms)[0m
[91m    Expected 0, but got 1.
[91m    at $LASTEXITCODE | Should -Be 0, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:831
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:831[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[32m   [+] Should not create backup in check-only mode[0m[90m 227ms (226ms|0ms)[0m
[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:854[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 854 | [0m             $contentBefore = [36;1mGet-Content $testFile -Raw[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m                              ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\test-project-360327632\.claude\commands\speckit.specify.md'[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mbecause it does not exist.[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:858[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 858 | [0m             $contentAfter = [36;1mGet-Content $testFile -Raw[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m                             ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\test-project-360327632\.claude\commands\speckit.specify.md'[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mbecause it does not exist.[0m
[32m   [+] Should not modify any files in check-only mode[0m[90m 231ms (231ms|1ms)[0m
[96m Context Additional Scenarios: Force Mode[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Prerequisites not met:
  X Not a SpecKit project (.specify/ directory not found)


========================================
Update Failed
========================================

Error: Prerequisites validation failed. Please fix the issues above and try again.

No backup available for automatic rollback

[91m   [-] Should overwrite customized files when --force is used[0m[90m 205ms (204ms|1ms)[0m
[91m    Expected like wildcard '*Official Version*' to match '# My Custom Version
[91m    Do not overwrite!
[91m    ', but it did not match.
[91m    at $content | Should -BeLike "*Official Version*", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:896
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:896[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Prerequisites not met:
  X Not a SpecKit project (.specify/ directory not found)


========================================
Update Failed
========================================

Error: Prerequisites validation failed. Please fix the issues above and try again.

No backup available for automatic rollback

[32m   [+] Should still preserve custom commands in force mode[0m[90m 178ms (177ms|1ms)[0m
[96m Context Additional Scenarios: Rollback Command[0m
[91m[-] Context Update Orchestrator Integration Tests.Additional Scenarios: Rollback Command failed[0m
[91m   ParameterBindingException: A parameter cannot be found that matches parameter name 'FromVersion'.
[91m   at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:921[0m
[96m Context Additional Scenarios: Error Handling[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Latest version: v0.0.72

Analyzing file changes...

========================================
Update Failed
========================================

Error: A parameter cannot be found that matches parameter name 'ProjectRoot'.

No backup available for automatic rollback

[91m   [-] Should fail gracefully when no internet connection[0m[90m 244ms (243ms|1ms)[0m
[91m    Expected like wildcard '*network*' to match <empty>, but it did not match.
[91m    at $output | Should -BeLike "*internet*" -Or ($output | Should -BeLike "*network*"), C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:997
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:997[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
No manifest found. Creating new manifest...

This will scan your current .specify/ and .claude/ directories
and mark all files as customized (safe default).


========================================
Update Failed
========================================

Error: Cannot process command because of one or more missing mandatory parameters: SpecKitVersion.

No backup available for automatic rollback

[32m   [+] Should validate prerequisites before starting[0m[90m 191ms (190ms|0ms)[0m

SpecKit Safe Update v1.0
======================================

Validating prerequisites...

Non-critical issues detected:
  ! Not a Git repository. Changes will not be tracked in version control.

Prerequisites validated successfully

Loading manifest...
Manifest loaded: v0.0.45

Checking for updates...
Target version: v999.999.999 (specified)

========================================
Update Failed
========================================

Error: Failed to fetch release information: GitHub resource not found: https://api.github.com/repos/github/spec-kit/releases/tags/v999.999.999

No backup available for automatic rollback

[91m   [-] Should handle invalid version specification[0m[90m 375ms (375ms|0ms)[0m
[91m    Expected like wildcard '*not found*' to match <empty>, but it did not match.
[91m    at $output | Should -BeLike "*version*" -Or ($output | Should -BeLike "*not found*"), C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:1028
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\integration\UpdateOrchestrator.Tests.ps1:1028[0m
[95m
[95mRunning tests from 'C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1'[0m
[92mDescribing BackupManager Module[0m
[96m Context New-SpecKitBackup[0m
Backup created: .specify/backups/20251020-135924
[32m   [+] Creates backup directory with timestamp format[0m[90m 87ms (84ms|3ms)[0m
Backup created: .specify/backups/20251020-135924
[32m   [+] Copies .specify directory contents (excluding backups)[0m[90m 80ms (80ms|0ms)[0m
Backup created: .specify/backups/20251020-135924
[32m   [+] Copies .claude directory if it exists[0m[90m 74ms (74ms|0ms)[0m
Backup created: .specify/backups/20251020-135924
[32m   [+] Handles missing .claude directory gracefully[0m[90m 85ms (74ms|11ms)[0m
[32m   [+] Throws error if not a SpecKit project[0m[90m 23ms (22ms|1ms)[0m
Backup created: .specify/backups/20251020-135924
[32m   [+] Returns valid backup path[0m[90m 83ms (83ms|0ms)[0m
Backup created: .specify/backups/20251020-135924
[32m   [+] Creates backup with all file contents intact[0m[90m 78ms (78ms|0ms)[0m
[96m Context Restore-SpecKitBackup[0m
Backup created: .specify/backups/20251020-135924
[31;1mGet-ChildItem: [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-1599590550\.specify\backups\20251020-135924\.specify'[0m
[31;1m[31;1mbecause it does not exist.[0m
Successfully restored from backup: C:\Users\bobby\AppData\Local\Temp\speckit-test-1599590550\.specify\backups\20251020-135924
[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:199[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 199 | [0m . edContent = [36;1mGet-Content (Join-Path $testProject ".specify/manifest.js[0m .[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-1599590550\.specify\manifest.json' because it[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mdoes not exist.[0m
[91m   [-] Restores .specify directory from backup[0m[90m 206ms (206ms|1ms)[0m
[91m    Expected 'Test manifest content
[91m    ', but got $null.
[91m    at $restoredContent | Should -Be "Test manifest content`r`n", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:200
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:200[0m
Backup created: .specify/backups/20251020-135925
[31;1mGet-ChildItem: [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-1823750188\.specify\backups\20251020-135925\.specify'[0m
[31;1m[31;1mbecause it does not exist.[0m
Successfully restored from backup: C:\Users\bobby\AppData\Local\Temp\speckit-test-1823750188\.specify\backups\20251020-135925
[32m   [+] Restores .claude directory from backup[0m[90m 227ms (226ms|0ms)[0m
Backup created: .specify/backups/20251020-135925
Backup created: .specify/backups/20251020-135925
[31;1mGet-ChildItem: [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-781142675\.specify\backups\20251020-135925\.specify'[0m
[31;1m[31;1mbecause it does not exist.[0m
Successfully restored from backup: C:\Users\bobby\AppData\Local\Temp\speckit-test-781142675\.specify\backups\20251020-135925
[32m   [+] Preserves backups directory during restore[0m[90m 476ms (476ms|0ms)[0m
[32m   [+] Throws error if backup path does not exist[0m[90m 24ms (23ms|0ms)[0m
[32m   [+] Throws error if backup is invalid (missing .specify)[0m[90m 26ms (26ms|0ms)[0m
Backup created: .specify/backups/20251020-135925
[31;1mGet-ChildItem: [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-921659424\.specify\backups\20251020-135925\.specify'[0m
[31;1m[31;1mbecause it does not exist.[0m
Successfully restored from backup: C:\Users\bobby\AppData\Local\Temp\speckit-test-921659424\.specify\backups\20251020-135925
[91m   [-] Handles missing .claude in backup gracefully[0m[90m 151ms (151ms|0ms)[0m
[91m    Expected $false, but got $true.
[91m    at Test-Path (Join-Path $testProject ".claude") | Should -Be $false, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:287
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:287[0m
Backup created: .specify/backups/20251020-135925
[31;1mGet-ChildItem: [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-1390252054\.specify\backups\20251020-135925\.specify'[0m
[31;1m[31;1mbecause it does not exist.[0m
Successfully restored from backup: C:\Users\bobby\AppData\Local\Temp\speckit-test-1390252054\.specify\backups\20251020-135925
[32m   [+] Completely replaces existing directories[0m[90m 209ms (208ms|0ms)[0m
[96m Context Get-SpecKitBackups[0m
[32m   [+] Returns empty array when no backups exist[0m[90m 25ms (24ms|1ms)[0m
Backup created: .specify/backups/20251020-135926
[32m   [+] Returns array of backup objects with correct properties[0m[90m 111ms (111ms|1ms)[0m
Backup created: .specify/backups/20251020-135926
Backup created: .specify/backups/20251020-135926
Backup created: .specify/backups/20251020-135926
[91m   [-] Returns backups sorted by CreatedAt descending (newest first)[0m[90m 442ms (442ms|0ms)[0m
[91m    Expected 3, but got 1.
[91m    at $backups.Count | Should -Be 3, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:367
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:367[0m
Backup created: .specify/backups/20251020-135926
[32m   [+] Calculates backup size correctly[0m[90m 98ms (97ms|2ms)[0m
[32m   [+] Returns empty array when backups directory does not exist[0m[90m 22ms (22ms|0ms)[0m
Backup created: .specify/backups/20251020-135926
[32m   [+] Includes timestamp in correct format[0m[90m 84ms (83ms|0ms)[0m
[96m Context Remove-OldBackups[0m
Backup created: .specify/backups/20251020-135927
Backup created: .specify/backups/20251020-135927
[32m   [+] Returns empty array when backup count is within limit[0m[90m 215ms (214ms|1ms)[0m
Backup created: .specify/backups/20251020-135927
Backup created: .specify/backups/20251020-135927
Backup created: .specify/backups/20251020-135927
Backup created: .specify/backups/20251020-135927
Backup created: .specify/backups/20251020-135927
Backup created: .specify/backups/20251020-135927
Backup created: .specify/backups/20251020-135927
[91m   [-] Keeps newest N backups and removes older ones[0m[90m 891ms (891ms|0ms)[0m
[91m    Expected 2, but got 0.
[91m    at $removed.Count | Should -Be 2, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:461
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:461[0m
Backup created: .specify/backups/20251020-135928
Backup created: .specify/backups/20251020-135928
Backup created: .specify/backups/20251020-135928
Backup created: .specify/backups/20251020-135928
Backup created: .specify/backups/20251020-135928
Backup created: .specify/backups/20251020-135928
Backup created: .specify/backups/20251020-135928
[91m   [-] WhatIf mode returns backups without deleting[0m[90m 899ms (898ms|0ms)[0m
[91m    Expected 2, but got 0.
[91m    at $wouldRemove.Count | Should -Be 2, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:490
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:490[0m
Backup created: .specify/backups/20251020-135929
Backup created: .specify/backups/20251020-135929
Backup created: .specify/backups/20251020-135929
Backup created: .specify/backups/20251020-135929
Backup created: .specify/backups/20251020-135929
[91m   [-] Respects custom KeepCount parameter[0m[90m 649ms (648ms|0ms)[0m
[91m    Expected 3, but got 0.
[91m    at $removed.Count | Should -Be 3, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:515
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:515[0m
Backup created: .specify/backups/20251020-135929
Backup created: .specify/backups/20251020-135929
Backup created: .specify/backups/20251020-135929
Backup created: .specify/backups/20251020-135930
Backup created: .specify/backups/20251020-135930
Backup created: .specify/backups/20251020-135930
Backup created: .specify/backups/20251020-135930
Backup created: .specify/backups/20251020-135930
[91m   [-] Uses default KeepCount of 5[0m[90m 997ms (997ms|0ms)[0m
[91m    Expected 3, but got 0.
[91m    at $removed.Count | Should -Be 3, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:540
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:540[0m
Backup created: .specify/backups/20251020-135930
Backup created: .specify/backups/20251020-135930
Backup created: .specify/backups/20251020-135930
Backup created: .specify/backups/20251020-135931
Backup created: .specify/backups/20251020-135931
Backup created: .specify/backups/20251020-135931
[91m   [-] Returns list of deleted backups[0m[90m 761ms (760ms|0ms)[0m
[91m    Expected 1, but got 0.
[91m    at $removed.Count | Should -Be 1, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:565
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:565[0m
Backup created: .specify/backups/20251020-135931
Backup created: .specify/backups/20251020-135931
Backup created: .specify/backups/20251020-135931
Backup created: .specify/backups/20251020-135931
Backup created: .specify/backups/20251020-135931
Backup created: .specify/backups/20251020-135932
[91m   [-] Handles backup deletion errors gracefully[0m[90m 763ms (762ms|0ms)[0m
[91m    Expected 1, but got 0.
[91m    at $removed.Count | Should -Be 1, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:594
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:594[0m
[96m Context Invoke-AutomaticRollback[0m
Backup created: .specify/backups/20251020-135932
AUTOMATIC ROLLBACK: Restoring from backup due to update failure...
[31;1mGet-ChildItem: [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-1038150971\.specify\backups\20251020-135932\.specify'[0m
[31;1m[31;1mbecause it does not exist.[0m
Successfully restored from backup: C:\Users\bobby\AppData\Local\Temp\speckit-test-1038150971\.specify\backups\20251020-135932
Automatic rollback completed successfully.
[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:615[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 615 | [0m . edContent = [36;1mGet-Content (Join-Path $testProject ".specify/manifest.js[0m .[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-1038150971\.specify\manifest.json' because it[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mdoes not exist.[0m
[91m   [-] Calls Restore-SpecKitBackup internally[0m[90m 173ms (173ms|1ms)[0m
[91m    Expected 'Test manifest content
[91m    ', but got $null.
[91m    at $restoredContent | Should -Be "Test manifest content`r`n", C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:616
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:616[0m
AUTOMATIC ROLLBACK: Restoring from backup due to update failure...
[31;1mInvoke-AutomaticRollback: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:629[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 629 | [0m .           { [36;1mInvoke-AutomaticRollback -ProjectRoot $testProject -Backu[0m .[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCRITICAL: Automatic rollback failed: Backup not found:[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mC:\Users\bobby\AppData\Local\Temp\speckit-test-904210864\.specify\backups\fake-backup[0m
[31;1mInvoke-AutomaticRollback: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:629[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 629 | [0m .           { [36;1mInvoke-AutomaticRollback -ProjectRoot $testProject -Backu[0m .[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mYour project may be in an inconsistent state.[0m
[31;1mInvoke-AutomaticRollback: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:629[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 629 | [0m .           { [36;1mInvoke-AutomaticRollback -ProjectRoot $testProject -Backu[0m .[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mManual restoration required from:[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mC:\Users\bobby\AppData\Local\Temp\speckit-test-904210864\.specify\backups\fake-backup[0m
[32m   [+] Throws error if backup restoration fails[0m[90m 29ms (28ms|0ms)[0m
Backup created: .specify/backups/20251020-135932
[31;1mGet-ChildItem: [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-1043364454\.specify\backups\20251020-135932\.specify'[0m
[31;1m[31;1mbecause it does not exist.[0m
[32m   [+] Outputs appropriate rollback messages[0m[90m 186ms (186ms|0ms)[0m
[96m Context Integration Tests[0m
Backup created: .specify/backups/20251020-135932
[31;1mGet-ChildItem: [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-323799250\.specify\backups\20251020-135932\.specify'[0m
[31;1m[31;1mbecause it does not exist.[0m
Successfully restored from backup: C:\Users\bobby\AppData\Local\Temp\speckit-test-323799250\.specify\backups\20251020-135932
[31;1mGet-Content: [0mC:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:674[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 674 | [0m . dManifest = [36;1mGet-Content (Join-Path $testProject ".specify/manifest.js[0m .[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-323799250\.specify\manifest.json' because it[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mdoes not exist.[0m
[91m   [-] Complete backup and restore workflow[0m[90m 174ms (173ms|1ms)[0m
[91m    Expected 'Test manifest content
[91m    ', but got $null.
[91m    at $restoredManifest | Should -Be $originalManifest, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:677
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:677[0m
Backup created: .specify/backups/20251020-135932
Backup created: .specify/backups/20251020-135932
Backup created: .specify/backups/20251020-135933
Backup created: .specify/backups/20251020-135933
Backup created: .specify/backups/20251020-135933
Backup created: .specify/backups/20251020-135933
Backup created: .specify/backups/20251020-135933
Backup created: .specify/backups/20251020-135933
Backup created: .specify/backups/20251020-135933
Backup created: .specify/backups/20251020-135933
[91m   [-] Multiple backup and cleanup workflow[0m[90m 1.28s (1.28s|0ms)[0m
[91m    Expected 5, but got 0.
[91m    at $removed.Count | Should -Be 5, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:699
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:699[0m
Backup created: .specify/backups/20251020-135934
Backup created: .specify/backups/20251020-135934
[31;1mGet-ChildItem: [31;1mCannot find path 'C:\Users\bobby\AppData\Local\Temp\speckit-test-1891258163\.specify\backups\20251020-135934\.specify'[0m
[31;1m[31;1mbecause it does not exist.[0m
Successfully restored from backup: C:\Users\bobby\AppData\Local\Temp\speckit-test-1891258163\.specify\backups\20251020-135934
[91m   [-] Backup survives restore of different backup[0m[90m 419ms (418ms|0ms)[0m
[91m    Expected 2, but got 1.
[91m    at $backups.Count | Should -Be 2, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:728
[91m    at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\BackupManager.Tests.ps1:728[0m
[95m
[95mRunning tests from 'C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\CodeStandards.Tests.ps1'[0m
[92mDescribing PowerShell Code Standards[0m
[96m Context Module vs. Helper Pattern Enforcement[0m
[32m   [+] Helper scripts (.ps1) should NOT contain Export-ModuleMember[0m[90m 5ms (4ms|1ms)[0m
[32m   [+] Module files (.psm1) SHOULD contain Export-ModuleMember[0m[90m 14ms (13ms|0ms)[0m
[32m   [+] All 7 helper scripts exist and have valid syntax[0m[90m 32ms (32ms|0ms)[0m
[33;1mWARNING: The names of some imported commands from the module 'GitHubApiClient' include unapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the Import-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.[0m
[32m   [+] All 6 module files exist and have valid syntax[0m[90m 30ms (30ms|0ms)[0m
[96m Context Orchestrator Structure[0m
[32m   [+] Orchestrator should have proper error handling for imports[0m[90m 3ms (3ms|1ms)[0m
[32m   [+] Orchestrator should use -WarningAction SilentlyContinue only (not -ErrorAction)[0m[90m 8ms (7ms|0ms)[0m
[32m   [+] Orchestrator should NOT redirect stderr to null (2>)[0m[90m 6ms (5ms|0ms)[0m
[95m
[95mRunning tests from 'C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1'[0m
[33;1mWARNING: The names of some imported commands from the module 'GitHubApiClient' include unapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the Import-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.[0m
[92mDescribing ConflictDetector Module[0m
[96m Context Get-FileState[0m
[92m  Describing Action: Skip (No Changes)[0m
[32m    [+] Returns skip when file unchanged and no upstream changes[0m[90m 28ms (27ms|1ms)[0m
[32m    [+] Returns skip when file doesn't exist anywhere[0m[90m 2ms (2ms|0ms)[0m
[92m  Describing Action: Add (New File)[0m
[32m    [+] Returns add when file doesn't exist locally but exists upstream[0m[90m 3ms (2ms|1ms)[0m
[92m  Describing Action: Remove (File Deleted Upstream)[0m
[32m    [+] Returns remove when file not customized and removed upstream[0m[90m 7ms (6ms|1ms)[0m
[32m    [+] Returns preserve when file customized and removed upstream[0m[90m 13ms (12ms|0ms)[0m
[92m  Describing Action: Update (Upstream Changed, Not Customized)[0m
[32m    [+] Returns update when file not customized but upstream changed[0m[90m 9ms (9ms|1ms)[0m
[92m  Describing Action: Preserve (Customized, No Upstream Change)[0m
[32m    [+] Returns preserve when file customized but no upstream changes[0m[90m 12ms (10ms|1ms)[0m
[92m  Describing Action: Merge (Conflict)[0m
[32m    [+] Returns merge when both customized and upstream changed[0m[90m 19ms (18ms|1ms)[0m
[32m    [+] Detects conflict with different modifications[0m[90m 15ms (15ms|0ms)[0m
[92m  Describing IsOfficial Flag[0m
[32m    [+] Preserves IsOfficial flag in output[0m[90m 13ms (13ms|1ms)[0m
[92m  Describing Hash Comparisons[0m
[32m    [+] Correctly identifies customization through hash comparison[0m[90m 6ms (5ms|1ms)[0m
[32m    [+] Correctly identifies upstream changes through hash comparison[0m[90m 15ms (15ms|0ms)[0m
[92m  Describing Edge Cases[0m
[91m    [-] Handles null OriginalHash[0m[90m 7ms (6ms|1ms)[0m
[91m     Expected strings to be the same, but they were different.
[91m     Expected length: 4
[91m     Actual length:   6
[91m     Strings differ at index 0.
[91m     Expected: 'skip'
[91m     But was:  'update'
[91m                ^
[91m     at $state.Action | Should -Be 'skip', C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:389
[91m     at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:389[0m
[32m    [+] Handles empty file[0m[90m 4ms (4ms|0ms)[0m
[32m    [+] Returns all required properties in output[0m[90m 6ms (6ms|0ms)[0m
[96m Context Get-AllFileStates[0m
[92m  Describing Tracked Files Processing[0m
[32m    [+] Processes all tracked files from manifest[0m[90m 64ms (63ms|1ms)[0m
[32m    [+] Detects new files in upstream not in manifest[0m[90m 30ms (29ms|0ms)[0m
[32m    [+] Handles both tracked and new upstream files[0m[90m 53ms (52ms|0ms)[0m
[92m  Describing Upstream Hash Computation[0m
[91m    [-] Correctly hashes upstream content for comparison[0m[90m 29ms (28ms|1ms)[0m
[91m     Expected 'skip', but got $null.
[91m     at $states[0].Action | Should -Be 'skip', C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:553
[91m     at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:553[0m
[91m    [-] Detects upstream changes through hash comparison[0m[90m 30ms (30ms|0ms)[0m
[91m     Expected $true, but got $null.
[91m     at $states[0].HasUpstreamChanges | Should -BeTrue, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:582
[91m     at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:582[0m
[92m  Describing File Removal Detection[0m
[91m    [-] Detects files removed from upstream[0m[90m 17ms (16ms|1ms)[0m
[91m     Expected 'remove', but got $null.
[91m     at $states[0].Action | Should -Be 'remove', C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:609
[91m     at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:609[0m
[92m  Describing Empty Collections[0m
[32m    [+] Handles empty manifest (no tracked files)[0m[90m 12ms (11ms|1ms)[0m
[91m    [-] Handles empty upstream templates[0m[90m 16ms (15ms|0ms)[0m
[91m     Expected 1, but got 9.
[91m     at $states.Count | Should -Be 1, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:648
[91m     at <ScriptBlock>, C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ConflictDetector.Tests.ps1:648[0m
[92m  Describing Conflict Detection[0m
[32m    [+] Identifies multiple conflicts correctly[0m[90m 72ms (71ms|1ms)[0m
[96m Context Test-FileCustomized[0m
[92m  Describing Customization Detection[0m
[32m    [+] Returns true for customized file[0m[90m 9ms (7ms|2ms)[0m
[32m    [+] Returns false for unchanged file[0m[90m 4ms (4ms|0ms)[0m
[32m    [+] Returns false when file doesn't exist[0m[90m 2ms (1ms|1ms)[0m
[32m    [+] Returns false when OriginalHash is null[0m[90m 4ms (3ms|1ms)[0m
[32m    [+] Returns false when OriginalHash is empty string[0m[90m 3ms (3ms|1ms)[0m
[92m  Describing Whitespace and Line Ending Normalization[0m
[32m    [+] Returns false when only trailing whitespace differs[0m[90m 15ms (14ms|1ms)[0m
[32m    [+] Returns false when only line endings differ (CRLF vs LF)[0m[90m 13ms (13ms|0ms)[0m
[32m    [+] Returns true when actual content differs[0m[90m 5ms (5ms|0ms)[0m
[96m Context Find-CustomCommands[0m
[92m  Describing Custom Command Identification[0m
[32m    [+] Identifies custom commands not in official list[0m[90m 27ms (26ms|1ms)[0m
[32m    [+] Returns empty array when no custom commands exist[0m[90m 20ms (19ms|0ms)[0m
[32m    [+] Returns empty array when commands directory doesn't exist[0m[90m 10ms (10ms|0ms)[0m
[32m    [+] Only scans .md files[0m[90m 21ms (20ms|0ms)[0m
[32m    [+] Returns all files when official list is empty[0m[90m 20ms (19ms|0ms)[0m
[92m  Describing Case Sensitivity[0m
[32m    [+] Handles case-sensitive comparison of filenames[0m[90m 22ms (21ms|1ms)[0m
[92m  Describing Real-world Scenarios[0m
[32m    [+] Handles typical SpecKit project structure[0m[90m 24ms (24ms|1ms)[0m
[95m
[95mRunning tests from 'C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\GitHubApiClient.Tests.ps1'[0m
[33;1mWARNING: The names of some imported commands from the module 'GitHubApiClient' include unapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the Import-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.[0m
[92mDescribing GitHubApiClient Module[0m
[96m Context Get-LatestSpecKitRelease[0m
[32m   [+] Returns latest release information from API[0m[90m 52ms (51ms|1ms)[0m
[32m   [+] Throws error when rate limit is exceeded[0m[90m 15ms (15ms|1ms)[0m
[32m   [+] Throws error when API returns 404[0m[90m 8ms (8ms|0ms)[0m
[32m   [+] Throws error when network is unavailable[0m[90m 12ms (12ms|0ms)[0m
[96m Context Get-SpecKitRelease[0m
[32m   [+] Returns specific release when version has v prefix[0m[90m 10ms (10ms|1ms)[0m
[32m   [+] Adds v prefix when version does not have it[0m[90m 8ms (8ms|0ms)[0m
[32m   [+] Throws error when release version does not exist[0m[90m 18ms (18ms|0ms)[0m
[96m Context Get-SpecKitReleaseAssets[0m
[32m   [+] Returns assets array from specific release[0m[90m 13ms (12ms|1ms)[0m
[32m   [+] Normalizes version before fetching assets[0m[90m 13ms (12ms|1ms)[0m
[96m Context Download-SpecKitTemplates[0m
[32m   [+] Downloads and extracts templates into hashtable[0m[90m 301ms (300ms|1ms)[0m
[32m   [+] Throws error when Claude templates asset is not found[0m[90m 15ms (15ms|0ms)[0m
[32m   [+] Cleans up temporary files after download[0m[90m 94ms (94ms|0ms)[0m
[32m   [+] Creates destination directory if it does not exist[0m[90m 70ms (70ms|0ms)[0m
[96m Context Test-GitHubApiRateLimit[0m
[32m   [+] Returns rate limit status from API[0m[90m 14ms (13ms|1ms)[0m
[96m Context Module Exports[0m
[32m   [+] Exports only public functions[0m[90m 16ms (15ms|1ms)[0m
[96m Context Error Handling[0m
[32m   [+] Handles rate limit error with reset time[0m[90m 16ms (15ms|1ms)[0m
[32m   [+] Handles generic HTTP errors[0m[90m 8ms (7ms|0ms)[0m
[95m
[95mRunning tests from 'C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\HashUtils.Tests.ps1'[0m
[92mDescribing HashUtils Module[0m
[96m Context Get-NormalizedHash[0m
[92m  Describing Line Ending Normalization[0m
[32m    [+] Produces same hash for CRLF and LF line endings[0m[90m 7ms (6ms|1ms)[0m
[32m    [+] Handles mixed line endings (CRLF and LF)[0m[90m 14ms (14ms|0ms)[0m
[32m    [+] Handles CR-only line endings[0m[90m 5ms (5ms|0ms)[0m
[92m  Describing Trailing Whitespace Normalization[0m
[32m    [+] Produces same hash with and without trailing whitespace[0m[90m 5ms (4ms|1ms)[0m
[32m    [+] Handles trailing tabs and mixed whitespace[0m[90m 4ms (4ms|0ms)[0m
[32m    [+] Preserves leading whitespace[0m[90m 4ms (4ms|0ms)[0m
[92m  Describing BOM Handling[0m
[32m    [+] Produces same hash with and without BOM[0m[90m 7ms (7ms|1ms)[0m
[32m    [+] Handles BOM with CRLF line endings[0m[90m 8ms (7ms|0ms)[0m
[92m  Describing Content Change Detection[0m
[32m    [+] Produces different hashes for different content[0m[90m 6ms (5ms|1ms)[0m
[32m    [+] Detects added lines[0m[90m 4ms (4ms|0ms)[0m
[32m    [+] Detects removed lines[0m[90m 5ms (4ms|0ms)[0m
[92m  Describing Empty File Handling[0m
[32m    [+] Produces consistent hash for empty files[0m[90m 4ms (4ms|1ms)[0m
[32m    [+] Handles file with only whitespace[0m[90m 4ms (4ms|0ms)[0m
[92m  Describing Error Handling[0m
[32m    [+] Throws when file does not exist[0m[90m 3ms (2ms|1ms)[0m
[32m    [+] Throws when file path is empty[0m[90m 2ms (2ms|0ms)[0m
[32m    [+] Throws when file path is null[0m[90m 2ms (1ms|0ms)[0m
[32m    [+] Handles locked files gracefully[0m[90m 5ms (4ms|0ms)[0m
[32m    [+] Handles permission denied gracefully[0m[90m 21ms (21ms|0ms)[0m
[92m  Describing Hash Format[0m
[32m    [+] Returns hash in sha256:HEXSTRING format[0m[90m 4ms (3ms|1ms)[0m
[32m    [+] Produces uppercase hex string[0m[90m 4ms (4ms|0ms)[0m
[92m  Describing Real-world Scenarios[0m
[32m    [+] Handles typical markdown file with CRLF (Windows)[0m[90m 4ms (3ms|1ms)[0m
[32m    [+] Handles PowerShell script with mixed whitespace[0m[90m 4ms (4ms|0ms)[0m
[32m    [+] Handles JSON file with BOM (VSCode default)[0m[90m 3ms (3ms|0ms)[0m
[96m Context Compare-FileHashes[0m
[92m  Describing Basic Comparison[0m
[32m    [+] Returns true for identical hashes[0m[90m 2ms (1ms|1ms)[0m
[32m    [+] Returns false for different hashes[0m[90m 1ms (1ms|0ms)[0m
[32m    [+] Returns false for hashes with different hex values[0m[90m 1ms (1ms|0ms)[0m
[92m  Describing Case Sensitivity[0m
[32m    [+] Returns true for hashes with different case[0m[90m 2ms (1ms|1ms)[0m
[32m    [+] Returns true for mixed case hashes[0m[90m 2ms (1ms|0ms)[0m
[92m  Describing Edge Cases[0m
[32m    [+] Handles full-length SHA-256 hashes (64 hex chars)[0m[90m 5ms (3ms|1ms)[0m
[32m    [+] Returns false for empty hash vs non-empty hash[0m[90m 2ms (1ms|1ms)[0m
[32m    [+] Returns true for two empty hashes[0m[90m 2ms (1ms|1ms)[0m
[92m  Describing Error Handling[0m
[32m    [+] Throws when Hash1 is null[0m[90m 3ms (2ms|1ms)[0m
[32m    [+] Throws when Hash2 is null[0m[90m 2ms (1ms|0ms)[0m
[32m    [+] Throws when Hash1 is empty string[0m[90m 2ms (1ms|0ms)[0m
[32m    [+] Throws when Hash2 is empty string[0m[90m 2ms (1ms|0ms)[0m
[92m  Describing Integration with Get-NormalizedHash[0m
[32m    [+] Correctly compares hashes from identical files[0m[90m 5ms (4ms|1ms)[0m
[32m    [+] Correctly compares hashes from different files[0m[90m 5ms (5ms|0ms)[0m
[32m    [+] Compares files with CRLF vs LF as identical[0m[90m 4ms (4ms|0ms)[0m
[95m
[95mRunning tests from 'C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\ManifestManager.Tests.ps1'[0m
[33;1mWARNING: The names of some imported commands from the module 'GitHubApiClient' include unapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the Import-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.[0m
[92mDescribing ManifestManager[0m
[96m Context Get-SpecKitManifest[0m
[32m   [+] Returns null when manifest doesn't exist[0m[90m 15ms (14ms|1ms)[0m
[32m   [+] Returns manifest when it exists[0m[90m 26ms (26ms|0ms)[0m
[32m   [+] Throws when manifest is corrupted[0m[90m 22ms (22ms|0ms)[0m
[32m   [+] Throws when manifest has missing version field[0m[90m 14ms (14ms|0ms)[0m
[32m   [+] Throws when manifest has unsupported schema version[0m[90m 18ms (18ms|0ms)[0m
[32m   [+] Uses current directory when ProjectRoot not specified[0m[90m 21ms (20ms|0ms)[0m
[96m Context New-SpecKitManifest[0m
[33;1mWARNING: Could not fetch official commands from GitHub: Claude templates asset not found in release v0.0.72. Available assets: spec-kit-template-auggie-ps-v0.0.72.zip, spec-kit-template-auggie-sh-v0.0.72.zip, spec-kit-template-claude-ps-v0.0.72.zip, spec-kit-template-claude-sh-v0.0.72.zip, spec-kit-template-codebuddy-ps-v0.0.72.zip, spec-kit-template-codebuddy-sh-v0.0.72.zip, spec-kit-template-codex-ps-v0.0.72.zip, spec-kit-template-codex-sh-v0.0.72.zip, spec-kit-template-copilot-ps-v0.0.72.zip, spec-kit-template-copilot-sh-v0.0.72.zip, spec-kit-template-cursor-agent-ps-v0.0.72.zip, spec-kit-template-cursor-agent-sh-v0.0.72.zip, spec-kit-template-gemini-ps-v0.0.72.zip, spec-kit-template-gemini-sh-v0.0.72.zip, spec-kit-template-kilocode-ps-v0.0.72.zip, spec-kit-template-kilocode-sh-v0.0.72.zip, spec-kit-template-opencode-ps-v0.0.72.zip, spec-kit-template-opencode-sh-v0.0.72.zip, spec-kit-template-q-ps-v0.0.72.zip, spec-kit-template-q-sh-v0.0.72.zip, spec-kit-template-qwen-ps-v0.0.72.zip, spec-kit-template-qwen-sh-v0.0.72.zip, spec-kit-template-roo-ps-v0.0.72.zip, spec-kit-template-roo-sh-v0.0.72.zip, spec-kit-template-windsurf-ps-v0.0.72.zip, spec-kit-template-windsurf-sh-v0.0.72.zip[0m
[33;1mWARNING: Using fallback command list[0m
[32m   [+] Creates manifest with valid structure[0m[90m 316ms (315ms|1ms)[0m
[32m   [+] Marks all files as customized when AssumeAllCustomized is set[0m[90m 60ms (60ms|0ms)[0m
[32m   [+] Distinguishes between official and custom commands[0m[90m 48ms (48ms|0ms)[0m
[32m   [+] Computes normalized hashes for all tracked files[0m[90m 44ms (44ms|0ms)[0m
[32m   [+] Excludes backups and manifest.json from tracked files[0m[90m 51ms (50ms|0ms)[0m
[32m   [+] Sets initialized_at and last_updated timestamps[0m[90m 52ms (52ms|0ms)[0m
[32m   [+] Creates manifest file on disk[0m[90m 48ms (47ms|1ms)[0m
[96m Context Get-OfficialSpecKitCommands[0m
[32m   [+] Returns list of official commands from GitHub[0m[90m 21ms (20ms|1ms)[0m
[32m   [+] Caches results for performance[0m[90m 19ms (18ms|0ms)[0m
[33;1mWARNING: Could not fetch official commands from GitHub: Network error[0m
[33;1mWARNING: Using fallback command list[0m
[32m   [+] Returns fallback list when GitHub API fails[0m[90m 16ms (15ms|0ms)[0m
[32m   [+] Handles templates with different path formats[0m[90m 14ms (14ms|0ms)[0m
[96m Context Update-ManifestVersion[0m
[32m   [+] Updates speckit_version field[0m[90m 25ms (24ms|1ms)[0m
[32m   [+] Updates last_updated timestamp[0m[90m 140ms (140ms|0ms)[0m
[32m   [+] Preserves other manifest fields[0m[90m 25ms (25ms|0ms)[0m
[32m   [+] Throws when manifest doesn't exist[0m[90m 13ms (12ms|0ms)[0m
[96m Context Add-TrackedFile[0m
[32m   [+] Adds file to tracked_files array[0m[90m 29ms (28ms|1ms)[0m
[32m   [+] Preserves existing tracked files[0m[90m 18ms (18ms|0ms)[0m
[32m   [+] Throws when manifest doesn't exist[0m[90m 13ms (13ms|0ms)[0m
[96m Context Remove-TrackedFile[0m
[32m   [+] Removes file from tracked_files array[0m[90m 26ms (25ms|1ms)[0m
[32m   [+] Doesn't error when file not in manifest[0m[90m 16ms (15ms|0ms)[0m
[32m   [+] Throws when manifest doesn't exist[0m[90m 13ms (13ms|0ms)[0m
[96m Context Update-FileHashes[0m
[32m   [+] Recomputes hashes for all tracked files[0m[90m 31ms (30ms|1ms)[0m
[32m   [+] Sets customized flag to false when file matches original[0m[90m 67ms (66ms|0ms)[0m
[33;1mWARNING: Tracked file not found: .claude/commands/speckit.specify.md[0m
[32m   [+] Updates last_updated timestamp[0m[90m 130ms (130ms|0ms)[0m
[33;1mWARNING: Tracked file not found: .claude/commands/speckit.specify.md[0m
[32m   [+] Warns about tracked files that don't exist[0m[90m 17ms (17ms|0ms)[0m
[32m   [+] Throws when manifest doesn't exist[0m[90m 14ms (14ms|0ms)[0m
[95m
[95mRunning tests from 'C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\UpdateOrchestrator.ModuleImport.Tests.ps1'[0m
[92mDescribing Update Orchestrator - Module Import Validation[0m
[96m Context When all modules load successfully[0m
[32m   [+] Should detect all required functions when modules load successfully[0m[90m 27ms (26ms|1ms)[0m
[96m Context When a module fails to load[0m
[32m   [+] Should detect missing functions when a module fails to load[0m[90m 14ms (13ms|1ms)[0m
[96m Context When Export-ModuleMember generates warnings[0m
[32m   [+] Should not treat Export-ModuleMember warnings as fatal errors[0m[90m 6ms (6ms|1ms)[0m
[0m
[92mDescribing Update Orchestrator - Error Suppression[0m
[96m Context When importing modules with warnings[0m
[32m   [+] Should suppress unapproved verb warnings during import[0m[90m 10ms (9ms|1ms)[0m
[0m
[92mDescribing Update Orchestrator - Verbose Logging[0m
[96m Context When running with verbose output[0m
[33;1mVERBOSE: Importing PowerShell modules from: C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\..\..\scripts\modules[0m
[33;1mVERBOSE: Validating module imports...[0m
[33;1mVERBOSE: Module validation successful: 6 critical functions available[0m
[32m   [+] Should display helpful diagnostic info with -Verbose flag[0m[90m 3ms (1ms|1ms)[0m
[95m
[95mRunning tests from 'C:\Users\bobby\src\claude-Win11-SpecKit-Safe-Update-Skill\tests\unit\VSCodeIntegration.Tests.ps1'[0m
[92mDescribing VSCodeIntegration Module[0m
[92m Describing Get-ExecutionContext[0m
[96m  Context When running in VSCode extension[0m
[32m    [+] Returns 'vscode-extension' when VSCODE_PID is set but TERM_PROGRAM is not 'vscode'[0m[90m 3ms (2ms|1ms)[0m
[96m  Context When running in VSCode terminal[0m
[32m    [+] Returns 'vscode-terminal' when VSCODE_PID is set and TERM_PROGRAM is 'vscode'[0m[90m 2ms (1ms|1ms)[0m
[96m  Context When running in standalone terminal[0m
[32m    [+] Returns 'standalone-terminal' when VSCODE_PID is not set[0m[90m 2ms (1ms|1ms)[0m
[92m Describing Show-QuickPick[0m
[96m  Context When running in VSCode context[0m
[32m    [+] Returns sentinel hashtable for Claude orchestration in vscode-extension context[0m[90m 8ms (7ms|1ms)[0m
[32m    [+] Returns sentinel hashtable with MultiSelect flag when specified[0m[90m 2ms (2ms|0ms)[0m
[96m  Context When running in standalone terminal[0m
[93m    [!] Falls back to numbered menu in standalone terminal[0m[90m 1ms (0ms|1ms)[0m
[93m    [!] Handles multi-select in terminal mode[0m[90m 0ms (0ms|0ms)[0m
[93m    [!] Validates input range in terminal mode[0m[90m 0ms (0ms|0ms)[0m
[92m Describing Open-DiffView[0m
[96m  Context When code command is available[0m
[93m    [!] Opens diff view with valid paths[0m[90m 1ms (0ms|1ms)[0m
[93m    [!] Opens diff view with title[0m[90m 0ms (0ms|0ms)[0m
[96m  Context Path validation[0m
[32m    [+] Throws error when left path does not exist[0m[90m 9ms (9ms|1ms)[0m
[32m    [+] Throws error when right path does not exist[0m[90m 13ms (13ms|0ms)[0m
[96m  Context When code command is not available[0m
[93m    [!] Throws error when code CLI is not found[0m[90m 1ms (0ms|1ms)[0m
[92m Describing Open-MergeEditor[0m
[96m  Context When code command is available[0m
[93m    [!] Returns true when result file is created[0m[90m 1ms (0ms|1ms)[0m
[93m    [!] Returns false when result file is not created[0m[90m 0ms (0ms|0ms)[0m
[93m    [!] Handles existing result file[0m[90m 0ms (0ms|0ms)[0m
[96m  Context Path validation[0m
[32m    [+] Throws error when base path does not exist[0m[90m 10ms (9ms|1ms)[0m
[96m  Context When code command is not available[0m
[93m    [!] Throws error when code CLI is not found[0m[90m 1ms (0ms|1ms)[0m
[92m Describing Show-Notification[0m
[96m  Context Message display[0m
Info message
[32m    [+] Displays info message without error[0m[90m 3ms (2ms|1ms)[0m
Warning message
[32m    [+] Displays warning message without error[0m[90m 2ms (2ms|0ms)[0m
Error message
[32m    [+] Displays error message without error[0m[90m 2ms (2ms|0ms)[0m
Default message
[32m    [+] Defaults to info level when not specified[0m[90m 2ms (2ms|0ms)[0m
[32m    [+] Validates level parameter[0m[90m 5ms (5ms|0ms)[0m
[92m Describing Module Export[0m
[32m   [+] Exports Get-ExecutionContext function[0m[90m 3ms (2ms|1ms)[0m
[32m   [+] Exports Show-QuickPick function[0m[90m 1ms (1ms|0ms)[0m
[32m   [+] Exports Open-DiffView function[0m[90m 1ms (1ms|0ms)[0m
[32m   [+] Exports Open-MergeEditor function[0m[90m 1ms (1ms|0ms)[0m
[32m   [+] Exports Show-Notification function[0m[90m 1ms (1ms|0ms)[0m
[97mTests completed in 26.37s[0m
[97mTests Passed: 181, [0m[91mFailed: 48, [0m[93mSkipped: 10, [0m[90mInconclusive: 0, [0m[37m[0m[90mNotRun: 0[0m
[91mBeforeAll \ AfterAll failed: 1[0m
[91m  - Update Orchestrator Integration Tests.Additional Scenarios: Rollback Command[0m
